var _$river={sandbox:function(){var e={};return{create:function(n,t){n=n.toLowerCase(),e[n]=t},run:function(n){var t={need:function(n){return n=n.toLowerCase(),e[n]&&e[n].call(t)||void 0}};n.call(t)}}}};_$river.module=_$river.sandbox();var define=_$river.module.create,main=_$river.module.run;define("river.engine",function(){function e(e){return i.need("river.grammer."+e)}function n(n,r){var o={hasRepeat:!1,context:r},i={scope:{},node:n,eom:{},reg:a};return n.attributes&&n.attributes.length&&c.loop(n.attributes,function(s){var u=s.nodeName,l=s.nodeValue.replace(a,""),p=e(u);"repeat"===u&&(o.hasRepeat=!0),"scope"===u?(o.context=i,p.call(o.context,l),r&&c.inherit(o.context.scope,r.scope)):c.isFunction(p)&&(o.context?(o.context.node=n,p.call(o.context,l),t(s,o.context)):(o.context=i,e("scope").call(o.context,l),p.call(o.context,l)))}),o}function t(e,n){if(a.test(e.nodeValue)){var t=e.nodeValue.replace(/\r|\n/g,"").replace(a,"");n.eom[t]||(n.eom[t]=[]),n.eom[t].push({element:e,expression:e.nodeValue}),e.nodeValue=e.nodeValue.replace(/\r|\n/g,"").replace(/{{.*}}/,n.scope[t])}}function r(e,n){e.childNodes&&e.childNodes.length&&c.loop(e.childNodes,function(e){o(e,n)})}function o(e,o){var i=n(e,o);i.context&&t(e,i.context),"CODE"===e.nodeName||"PRE"===e.nodeName||i.hasRepeat||(i.context?r(e,i.context):r(e))}var i=this,c=i.need("river.core.tools"),a=/.*{{\s*|\s*}}.*/g;return{scan:o}}),main(function(){var e=this;document.addEventListener("DOMContentLoaded",function(){var n=e.need("river.engine").scan;n(document)})}),define("river.scenario",function(){function e(e,n){var t=document.createEvent("MouseEvents");t.initEvent(e,!0,!0),n.dispatchEvent(t)}this.need("river.core.tools");return{trigger:e}}),define("river.core.Date",function(){function e(e){var n={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var t in n)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[t]:("00"+n[t]).substr((""+n[t]).length)));return e}var n=function(n){var t=new Date,r=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours()+parseInt(n),t.getUTCMinutes(),t.getUTCSeconds());return{date:r,toString:function(n){return r.toString=e,r.toString(n)}}};return{getDateByCity:n}}),define("river.core.model",function(){function e(n,t,r){a(n)||s(n)?l(r[t],function(e){e.element.nodeValue=e.expression.replace(/{{.*}}/,n)}):i(n)?l(n,function(n,o){e(n,o,r[t][o])}):c(n)&&u(n,function(n,t){e(n,t,r)})}function n(e,n,t){r[e]=n,o[e]={},this.$$ns=e;for(var i in t)this[i]=t[i],last[i]=t[i]}var t=this.need("river.core.tools"),r={},o={},i=t.isArray,c=t.isObject,a=t.isString,s=t.isNumber,u=t.each,l=t.loop;return n.prototype.apply=function(){var n=r[this.$$ns],t=o[this.$$ns];u(this,function(r,o){n[o]&&t[o]!==r&&(e(r,o,n),t[o]=r)})},n.prototype.watch=function(){},n.prototype.inject=function(e){var n=this;u(e,function(t,r){n[r]=e[r]})},n}),define("river.core.tools",function(){var e=Object.prototype.toString,n={inherit:function(e,n){var t=function(){for(var n in e)e.hasOwnProperty&&e.hasOwnProperty(n)?this[n]=e[n]:t.prototype[n]=e[n]};for(var r in n)t.prototype[r]=n[r];var o=new t;for(var i in o)e[i]=o[i];return e},compile:function(e){var n=document.createElement("div");return n.innerHTML=e,n.childNodes[0]},guid:function(){for(var e="$$",n=1;8>=n;n++){var t=Math.floor(16*Math.random()).toString(16);e+=t,(3==n||5==n)&&(e+="-")}return e},loop:function(e,n){for(var t={},r=0;r<e.length;r++)n.call(t,e[r],r)},each:function(e,n){var t={};for(var r in e)e.hasOwnProperty&&e.hasOwnProperty(r)&&n.call(t,e[r],r)},log:function(){console&&Function.apply.call(console.log,console,arguments)},isArray:function(n){return"[object Array]"===e.apply(n)},isObject:function(e){return null!==e&&"object"==typeof e},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e}};return n}),define("river.grammer.jbind",function(){function e(e){function n(n){n!==o&&(r[e]=n,o=n,r.apply())}var t,r=this.scope,o=this.node.value=r[e];this.node.onfocus=function(){var e=this;t=setInterval(function(){n(e.value)},30)},this.node.onblur=function(){clearInterval(t)}}return e}),define("river.grammer.jChange",function(){function e(e){var n=this.scope[e],t=this.scope;this.node.onchange=function(){n.call({},this.value),t.apply()}}return e}),define("river.grammer.jclick",function(){function e(e){var n=e.replace(/\(.*\)/,""),t=this.scope[n],r=this.scope,o=/\((.*)\)/,i=e.match(o),c=[];i&&i.length&&(c=i[1].split(",")),this.node.onclick=function(){t.apply({},c),r.apply()}}return e}),define("river.grammer.jcompile",function(){return function(){{var e=this.node,n=(this.scope,this.reg);e.textContent.replace(n,"")}}}),define("river.grammer.repeat",function(){function e(e){var t=/.*in\s/,r=/\sin.*/,o=/.*\./,i=e.replace(t,"").replace(o,""),c=this.scope[i],a=e.replace(r,""),s=this.node.parentNode,u=s.removeChild(this.node),l=document.createDocumentFragment(),p=this.reg,d=this.eom[i]=[];u.removeAttribute("repeat"),c&&c.length&&(c.forEach(function(e){var t=u.cloneNode(!0),r={};n(p,t,e,a,r),d.push(r),l.appendChild(t)}),s.appendChild(l))}function n(o,i,c,a,s){var u=!1;if(i.attributes&&i.attributes.length&&Array.prototype.forEach.call(i.attributes,function(n){if(o.test(n.nodeValue)){var t=n.nodeValue.replace(o,"").replace(a+".","");s[t]||(s[t]=[]),s[t].push({element:n,expression:n.nodeValue}),n.nodeValue=n.nodeValue.replace(/{{.*}}/,c[t])}"repeat"===n.nodeName&&(u=!0,r.node=i,r.scope=c,r.reg=o,r.eom=s,e.call(r,n.nodeValue.replace(o,"")))}),o.test(i.nodeValue)){var l=i.nodeValue.replace(o,"").replace(a+".","");s[l]||(s[l]=[]),s[l].push({element:i,expression:i.nodeValue});var p=t.isObject(c)?c[l]:c;i.nodeValue=i.nodeValue.replace(/{{.*}}/,p)}i.childNodes&&i.childNodes.length&&!u&&Array.prototype.forEach.call(i.childNodes,function(e){n(o,e,c,a,s)})}var t=this.need("river.core.tools"),r={};return e}),define("river.grammer.scope",function(){function e(e){var o=n.need(e);if(r.isObject(o))this.scope=o;else if(r.isFunction(o)){var i=new t(e,this.eom);this.scope=i,o.call(i)}else{var c=r.guid();this.scope=new t(c,this.eom)}}var n=this,t=n.need("river.core.model"),r=n.need("river.core.tools");return e});
//# sourceMappingURL=river.map